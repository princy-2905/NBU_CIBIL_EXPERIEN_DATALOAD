select cast( dateopeneddisbursed as date) from nbu.cibil_account_segment

truncate table "digital-revenue".nbu.cibil_account_segment;

insert into nbu.cibil_account_segment
select 

cast ( memberreference as numeric),
cast(acct_number as varchar(max) ) ,
cast(membershortname as varchar(max) ) ,
cast(enr_enq_pa as varchar(5) ) ,
cast(reportingmembershortname as varchar(max) ) ,
cast(accountnumber as varchar(max) ) ,
cast(accounttype as varchar(max) ) ,
cast(ownershipindicator as numeric ) ,
to_date(LPAD(TRIM(BOTH ' ' FROM dateopeneddisbursed), 8, '0') , 'DDMMYYYY') as dateopeneddisbursed ,
to_date(LPAD(TRIM(BOTH ' ' FROM dateoflastpayment), 8, '0') , 'DDMMYYYY') as dateoflastpayment ,
to_date(LPAD(TRIM(BOTH ' ' FROM dateclosed), 8, '0') , 'DDMMYYYY') as dateclosed ,
to_date(LPAD(TRIM(BOTH ' ' FROM datereported_trades), 8, '0') , 'DDMMYYYY') as datereported_trades ,
cast(highcreditsanctionedamount as numeric ) ,
cast(currentbalance as numeric ) ,
cast(amountoverdue as numeric ) ,
cast(paymt_hst_01 as varchar(10) ) ,
cast(paymt_hst_02 as varchar(10) ) ,
cast(paymt_hst_03 as varchar(10) ) ,
cast(paymt_hst_04 as varchar(10) ) ,
cast(paymt_hst_05 as varchar(10) ) ,
cast(paymt_hst_06 as varchar(10) ) ,
cast(paymt_hst_07 as varchar(10) ) ,
cast(paymt_hst_08 as varchar(10) ) ,
cast(paymt_hst_09 as varchar(10) ) ,
cast(paymt_hst_10 as varchar(10) ) ,
cast(paymt_hst_11 as varchar(10) ) ,
cast(paymt_hst_12 as varchar(10) ) ,
cast(paymt_hst_13 as varchar(10) ) ,
cast(paymt_hst_14 as varchar(10) ) ,
cast(paymt_hst_15 as varchar(10) ) ,
cast(paymt_hst_16 as varchar(10) ) ,
cast(paymt_hst_17 as varchar(10) ) ,
cast(paymt_hst_18 as varchar(10) ) ,
cast(paymt_hst_19 as varchar(10) ) ,
cast(paymt_hst_20 as varchar(10) ) ,
cast(paymt_hst_21 as varchar(10) ) ,
cast(paymt_hst_22 as varchar(10) ) ,
cast(paymt_hst_23 as varchar(10) ) ,
cast(paymt_hst_24 as varchar(10) ) ,
cast(paymt_hst_25 as varchar(10) ) ,
cast(paymt_hst_26 as varchar(10) ) ,
cast(paymt_hst_27 as varchar(10) ) ,
cast(paymt_hst_28 as varchar(10) ) ,
cast(paymt_hst_29 as varchar(10) ) ,
cast(paymt_hst_30 as varchar(10) ) ,
cast(paymt_hst_31 as varchar(10) ) ,
cast(paymt_hst_32 as varchar(10) ) ,
cast(paymt_hst_33 as varchar(10) ) ,
cast(paymt_hst_34 as varchar(10) ) ,
cast(paymt_hst_35 as varchar(10) ) ,
cast(paymt_hst_36 as varchar(10) ) ,
to_date(LPAD(TRIM(BOTH ' ' FROM pay_hist_start_date), 8, '0') , 'DDMMYYYY') as pay_hist_start_date ,
to_date(LPAD(TRIM(BOTH ' ' FROM pay_hist_end_date), 8, '0') , 'DDMMYYYY') as pay_hist_end_date ,
cast(suit_filed_status as varchar(10) ) ,
cast(credit_facility_status as varchar(10) ) ,
cast(collateral_type as numeric ) ,
cast(collateral_value as numeric ) ,
cast(credit_limit as numeric ) ,
cast(cash_limit as numeric ) ,
cast(roi as decimal(10,5) ) ,
cast(tenure as numeric ) ,
cast(emi_amt as numeric ) ,
cast(writeoff_amt_tot as numeric ) ,
cast(writeoff_amt_prin as numeric ) ,
cast(settlement_amt as numeric ) ,
cast(paymt_freq as numeric ) ,
cast(actual_paymt_amt as numeric )  ,
cast(dateofentry_errorcode_tl as numeric ) ,
cast(errorcode_tl as numeric ) ,
cast(date_cibilremarkscode_tl as numeric ) ,
cast(cibilremarkscode_tl as numeric ) ,
cast(disputeremarkscode_tl as numeric ) ,
cast(disputeremarkscode1_tl as numeric ) ,
cast(disputeremarkscode2_tl as numeric ) ,
getdate(),
getdate()
from "digital-revenue"."nbu"."stg_cibil_data"
where accounttype is not null




----create table

CREATE TABLE nbu.cibil_account_segment (
    member_reference integer ENCODE az64,
    acct_number character varying(65535) ENCODE lzo,
    membershortname character varying(65535) ENCODE lzo,
    enr_enq_pa character varying(5) ENCODE lzo,
    reportingmembershortname character varying(65535) ENCODE lzo,
    accountnumber character varying(65535) ENCODE lzo,
    accounttype character varying(65535) ENCODE lzo,
    ownershipindicator integer ENCODE az64,
    dateopeneddisbursed date ENCODE az64,
    dateoflastpayment date ENCODE az64,
    dateclosed date ENCODE az64,
    datereported_trades date ENCODE az64,
    highcreditsanctionedamount bigint ENCODE az64,
    currentbalance bigint ENCODE az64,
    amountoverdue bigint ENCODE az64,
    paymt_hst_01 character varying(10) ENCODE lzo,
    paymt_hst_02 character varying(10) ENCODE lzo,
    paymt_hst_03 character varying(10) ENCODE lzo,
    paymt_hst_04 character varying(10) ENCODE lzo,
    paymt_hst_05 character varying(10) ENCODE lzo,
    paymt_hst_06 character varying(10) ENCODE lzo,
    paymt_hst_07 character varying(10) ENCODE lzo,
    paymt_hst_08 character varying(10) ENCODE lzo,
    paymt_hst_09 character varying(10) ENCODE lzo,
    paymt_hst_10 character varying(10) ENCODE lzo,
    paymt_hst_11 character varying(10) ENCODE lzo,
    paymt_hst_12 character varying(10) ENCODE lzo,
    paymt_hst_13 character varying(10) ENCODE lzo,
    paymt_hst_14 character varying(10) ENCODE lzo,
    paymt_hst_15 character varying(10) ENCODE lzo,
    paymt_hst_16 character varying(10) ENCODE lzo,
    paymt_hst_17 character varying(10) ENCODE lzo,
    paymt_hst_18 character varying(10) ENCODE lzo,
    paymt_hst_19 character varying(10) ENCODE lzo,
    paymt_hst_20 character varying(10) ENCODE lzo,
    paymt_hst_21 character varying(10) ENCODE lzo,
    paymt_hst_22 character varying(10) ENCODE lzo,
    paymt_hst_23 character varying(10) ENCODE lzo,
    paymt_hst_24 character varying(10) ENCODE lzo,
    paymt_hst_25 character varying(10) ENCODE lzo,
    paymt_hst_26 character varying(10) ENCODE lzo,
    paymt_hst_27 character varying(10) ENCODE lzo,
    paymt_hst_28 character varying(10) ENCODE lzo,
    paymt_hst_29 character varying(10) ENCODE lzo,
    paymt_hst_30 character varying(10) ENCODE lzo,
    paymt_hst_31 character varying(10) ENCODE lzo,
    paymt_hst_32 character varying(10) ENCODE lzo,
    paymt_hst_33 character varying(10) ENCODE lzo,
    paymt_hst_34 character varying(10) ENCODE lzo,
    paymt_hst_35 character varying(10) ENCODE lzo,
    paymt_hst_36 character varying(10) ENCODE lzo,
    pay_hist_start_date date ENCODE az64,
    pay_hist_end_date date ENCODE az64,
    suit_filed_status character varying(10) ENCODE lzo,
    credit_facility_status character varying(10) ENCODE lzo,
    collateral_type integer ENCODE az64,
    collateral_value integer ENCODE az64,
    credit_limit integer ENCODE az64,
    cash_limit integer ENCODE az64,
    roi double precision ENCODE raw,
    tenure integer ENCODE az64,
    emi_amt integer ENCODE az64,
    writeoff_amt_tot integer ENCODE az64,
    writeoff_amt_prin integer ENCODE az64,
    settlement_amt integer ENCODE az64,
    paymt_freq integer ENCODE az64,
    actual_paymt_amt integer ENCODE az64,
    dateofentry_errorcode_tl integer ENCODE az64,
    errorcode_tl integer ENCODE az64,
    date_cibilremarkscode_tl integer ENCODE az64,
    cibilremarkscode_tl integer ENCODE az64,
    disputeremarkscode_tl integer ENCODE az64,
    disputeremarkscode1_tl integer ENCODE az64,
    disputeremarkscode2_tl integer ENCODE az64,
    created_at date ENCODE az64,
    updated_at date ENCODE az64
) DISTSTYLE AUTO;