Drop table nbu.cibil_user_summary;
create table nbu.cibil_user_summary(
response_id varchar(max),
id int,
"Sequence No" Varchar(MAX),
"Account No" Varchar(MAX),
"Adviser Transaction No" Varchar(MAX),
"Member Reference" Varchar(MAX),
"Total Features" Varchar(MAX),
PP001ALL Varchar(MAX),
PP002ALL Varchar(MAX),
PP003ALL Varchar(MAX),
PP004ALL Varchar(MAX),
PP005ALL Varchar(MAX),
PP009ALL Varchar(MAX),
PP010ALL Varchar(MAX),
PP011ALL Varchar(MAX),
PP012ALL Varchar(MAX),
PP013ALL Varchar(MAX),
PP014ALL Varchar(MAX),
PP015ALL Varchar(MAX),
PP016ALL Varchar(MAX),
PP105ALL Varchar(MAX),
PP106ALL Varchar(MAX),
PP107ALL Varchar(MAX),
PP108ALL Varchar(MAX),
PP109ALL Varchar(MAX),
PP110ALL Varchar(MAX),
PP111ALL Varchar(MAX),
PP112ALL Varchar(MAX),
PP113ALL Varchar(MAX),
PP114ALL Varchar(MAX),
PP120ALL Varchar(MAX),
PP121ALL Varchar(MAX),
PP122ALL Varchar(MAX),
PP123ALL Varchar(MAX),
PP124ALL Varchar(MAX),
PP300ALL Varchar(MAX),
PP301ALL Varchar(MAX),
PP302ALL Varchar(MAX),
PP303ALL Varchar(MAX),
PP304ALL Varchar(MAX),
PP305ALL Varchar(MAX),
PP317ALL Varchar(MAX),
PP318ALL Varchar(MAX),
PP319ALL Varchar(MAX),
PP320ALL Varchar(MAX),
PP321ALL Varchar(MAX),
PP322ALL Varchar(MAX),
PP323ALL Varchar(MAX),
PP324ALL Varchar(MAX),
PP325ALL Varchar(MAX),
PP326ALL Varchar(MAX),
PP327ALL Varchar(MAX),
PP328ALL Varchar(MAX),
PP335ALL Varchar(MAX),
PP336ALL Varchar(MAX),
PP337ALL Varchar(MAX),
PP338ALL Varchar(MAX),
PP339ALL Varchar(MAX),
PP340ALL Varchar(MAX),
PP366ALL Varchar(MAX),
PP367ALL Varchar(MAX),
PP368ALL Varchar(MAX),
PP369ALL Varchar(MAX),
PP370ALL Varchar(MAX),
PP371ALL Varchar(MAX),
PP377ALL Varchar(MAX),
PP378ALL Varchar(MAX),
PP379ALL Varchar(MAX),
PP380ALL Varchar(MAX),
PP381ALL Varchar(MAX),
PP382ALL Varchar(MAX),
PP388ALL Varchar(MAX),
PP389ALL Varchar(MAX),
PP390ALL Varchar(MAX),
PP391ALL Varchar(MAX),
PP392ALL Varchar(MAX),
PP393ALL Varchar(MAX),
PP504ALL Varchar(MAX),
PP530ALL Varchar(MAX),
PP533ALL Varchar(MAX),
PP539ALL Varchar(MAX),
PP547ALL Varchar(MAX),
PP557ALL Varchar(MAX),
PP566ALL Varchar(MAX),
EQ002ALL Varchar(MAX),
EQ003ALL Varchar(MAX),
EQ005ALL Varchar(MAX),
PP001CRD Varchar(MAX),
PP002CRD Varchar(MAX),
PP003CRD Varchar(MAX),
PP004CRD Varchar(MAX),
PP005CRD Varchar(MAX),
PP009CRD Varchar(MAX),
PP010CRD Varchar(MAX),
PP011CRD Varchar(MAX),
PP012CRD Varchar(MAX),
PP013CRD Varchar(MAX),
PP014CRD Varchar(MAX),
PP015CRD Varchar(MAX),
PP016CRD Varchar(MAX),
PP105CRD Varchar(MAX),
PP106CRD Varchar(MAX),
PP107CRD Varchar(MAX),
PP108CRD Varchar(MAX),
PP109CRD Varchar(MAX),
PP110CRD Varchar(MAX),
PP111CRD Varchar(MAX),
PP112CRD Varchar(MAX),
PP113CRD Varchar(MAX),
PP114CRD Varchar(MAX),
PP120CRD Varchar(MAX),
PP121CRD Varchar(MAX),
PP122CRD Varchar(MAX),
PP123CRD Varchar(MAX),
PP124CRD Varchar(MAX),
PP300CRD Varchar(MAX),
PP301CRD Varchar(MAX),
PP302CRD Varchar(MAX),
PP303CRD Varchar(MAX),
PP304CRD Varchar(MAX),
PP305CRD Varchar(MAX),
PP317CRD Varchar(MAX),
PP318CRD Varchar(MAX),
PP319CRD Varchar(MAX),
PP320CRD Varchar(MAX),
PP321CRD Varchar(MAX),
PP322CRD Varchar(MAX),
PP323CRD Varchar(MAX),
PP324CRD Varchar(MAX),
PP325CRD Varchar(MAX),
PP326CRD Varchar(MAX),
PP327CRD Varchar(MAX),
PP328CRD Varchar(MAX),
PP335CRD Varchar(MAX),
PP336CRD Varchar(MAX),
PP337CRD Varchar(MAX),
PP338CRD Varchar(MAX),
PP339CRD Varchar(MAX),
PP340CRD Varchar(MAX),
PP366CRD Varchar(MAX),
PP367CRD Varchar(MAX),
PP368CRD Varchar(MAX),
PP369CRD Varchar(MAX),
PP370CRD Varchar(MAX),
PP371CRD Varchar(MAX),
PP377CRD Varchar(MAX),
PP378CRD Varchar(MAX),
PP379CRD Varchar(MAX),
PP380CRD Varchar(MAX),
PP381CRD Varchar(MAX),
PP382CRD Varchar(MAX),
PP388CRD Varchar(MAX),
PP389CRD Varchar(MAX),
PP390CRD Varchar(MAX),
PP391CRD Varchar(MAX),
PP392CRD Varchar(MAX),
PP393CRD Varchar(MAX),
PP504CRD Varchar(MAX),
PP530CRD Varchar(MAX),
PP533CRD Varchar(MAX),
PP539CRD Varchar(MAX),
PP547CRD Varchar(MAX),
PP557CRD Varchar(MAX),
PP566CRD Varchar(MAX),
EQ002CRD Varchar(MAX),
EQ003CRD Varchar(MAX),
EQ005CRD Varchar(MAX),
PP001PLN Varchar(MAX),
PP002PLN Varchar(MAX),
PP003PLN Varchar(MAX),
PP004PLN Varchar(MAX),
PP005PLN Varchar(MAX),
PP009PLN Varchar(MAX),
PP010PLN Varchar(MAX),
PP011PLN Varchar(MAX),
PP012PLN Varchar(MAX),
PP013PLN Varchar(MAX),
PP014PLN Varchar(MAX),
PP015PLN Varchar(MAX),
PP016PLN Varchar(MAX),
PP105PLN Varchar(MAX),
PP106PLN Varchar(MAX),
PP107PLN Varchar(MAX),
PP108PLN Varchar(MAX),
PP109PLN Varchar(MAX),
PP110PLN Varchar(MAX),
PP111PLN Varchar(MAX),
PP112PLN Varchar(MAX),
PP113PLN Varchar(MAX),
PP114PLN Varchar(MAX),
PP120PLN Varchar(MAX),
PP121PLN Varchar(MAX),
PP122PLN Varchar(MAX),
PP123PLN Varchar(MAX),
PP124PLN Varchar(MAX),
PP300PLN Varchar(MAX),
PP301PLN Varchar(MAX),
PP302PLN Varchar(MAX),
PP303PLN Varchar(MAX),
PP304PLN Varchar(MAX),
PP305PLN Varchar(MAX),
PP317PLN Varchar(MAX),
PP318PLN Varchar(MAX),
PP319PLN Varchar(MAX),
PP320PLN Varchar(MAX),
PP321PLN Varchar(MAX),
PP322PLN Varchar(MAX),
PP323PLN Varchar(MAX),
PP324PLN Varchar(MAX),
PP325PLN Varchar(MAX),
PP326PLN Varchar(MAX),
PP327PLN Varchar(MAX),
PP328PLN Varchar(MAX),
PP335PLN Varchar(MAX),
PP336PLN Varchar(MAX),
PP337PLN Varchar(MAX),
PP338PLN Varchar(MAX),
PP339PLN Varchar(MAX),
PP340PLN Varchar(MAX),
PP366PLN Varchar(MAX),
PP367PLN Varchar(MAX),
PP368PLN Varchar(MAX),
PP369PLN Varchar(MAX),
PP370PLN Varchar(MAX),
PP371PLN Varchar(MAX),
PP377PLN Varchar(MAX),
PP378PLN Varchar(MAX),
PP379PLN Varchar(MAX),
PP380PLN Varchar(MAX),
PP381PLN Varchar(MAX),
PP382PLN Varchar(MAX),
PP388PLN Varchar(MAX),
PP389PLN Varchar(MAX),
PP390PLN Varchar(MAX),
PP391PLN Varchar(MAX),
PP392PLN Varchar(MAX),
PP393PLN Varchar(MAX),
PP504PLN Varchar(MAX),
PP530PLN Varchar(MAX),
PP533PLN Varchar(MAX),
PP539PLN Varchar(MAX),
PP547PLN Varchar(MAX),
PP557PLN Varchar(MAX),
PP566PLN Varchar(MAX),
EQ002PLN Varchar(MAX),
EQ003PLN Varchar(MAX),
EQ005PLN Varchar(MAX),
PP001MTG Varchar(MAX),
PP009MTG Varchar(MAX),
PP011MTG Varchar(MAX),
PP012MTG Varchar(MAX),
PP016MTG Varchar(MAX),
PP300MTG Varchar(MAX),
PP301MTG Varchar(MAX),
PP302MTG Varchar(MAX),
PP303MTG Varchar(MAX),
PP304MTG Varchar(MAX),
PP305MTG Varchar(MAX),
PP366MTG Varchar(MAX),
PP367MTG Varchar(MAX),
PP368MTG Varchar(MAX),
PP369MTG Varchar(MAX),
PP370MTG Varchar(MAX),
PP371MTG Varchar(MAX),
PP504MTG Varchar(MAX),
"Secured Accounts Count" Varchar(MAX),
"Unsecured Accounts Count" Varchar(MAX),
"Secured High Credit Sum" Varchar(MAX),
"Unsecured High Credit Sum" Varchar(MAX),
"Secured Amount Overdue Sum" Varchar(MAX),
"Unsecured Amount Overdue Sum" Varchar(MAX),
"Secured Balances Sum" Varchar(MAX),
"Unsecured Balances Sum" Varchar(MAX),
"Own Accounts count" Varchar(MAX),
"Other Accounts count" Varchar(MAX),
"CIBILTUSC3 Score Value" Varchar(MAX),
"CIBILTUSC3 Score Reason Code Set" Varchar(MAX),
"CIBILTUSC3 Score Exclusion Code Set" Varchar(MAX),
"CIBILTUSC3 Score Error Code Set" Varchar(MAX)
);


--load into staging table

COPY  "digital-revenue"."nbu"."stg_cibil_user_summary" FROM 's3://angelone-nbu/cibil/scrub_2023-08-18/SB93209999_CIRBATCH_17082023_Sample_Data_Angel_1L_18-08-2023-11-08-06_CV_STD_71_CIR.csv'
IAM_ROLE 'arn:aws:iam::555445901246:role/analytics-redshift-glue-role' DELIMITER ','  ignoreheader 1 REMOVEQUOTES BLANKSASNULL  EMPTYASNULL



--insert into main table 

truncate table nbu.cibil_user_summary ;
Insert into nbu.cibil_user_summary
select
response_id,
ROW_NUMBER() over(order by response_id),
CAST("Sequence No" as int),
CAST("Account No" as VARCHAR(MAX)) ,
CAST("Adviser Transaction No" as  DECIMAL(18,5)),
CAST("Member Reference" as int),
CAST("Total Features" as int) ,
CAST(PP001ALL as DECIMAL(18,5)),
CAST(PP002ALL as DECIMAL(18,5)),
CAST(PP003ALL as DECIMAL(18,5)),
CAST(PP004ALL as DECIMAL(18,5)),
CAST(PP005ALL as DECIMAL(18,5)),
CAST(PP009ALL as DECIMAL(18,5)),
CAST(PP010ALL as DECIMAL(18,5)),
CAST(PP011ALL as DECIMAL(18,5)),
CAST(PP012ALL as DECIMAL(18,5)),
CAST(PP013ALL as DECIMAL(18,5)),
CAST(PP014ALL as DECIMAL(18,5)),
CAST(PP015ALL as DECIMAL(18,5)),
CAST(PP016ALL as DECIMAL(18,5)),
CAST(PP105ALL as DECIMAL(18,5)),
CAST(PP106ALL as DECIMAL(18,5)),
CAST(PP107ALL as DECIMAL(18,5)),
CAST(PP108ALL as DECIMAL(18,5)),
CAST(PP109ALL as DECIMAL(18,5)),
CAST(PP110ALL as DECIMAL(18,5)),
CAST(PP111ALL as DECIMAL(18,5)),
CAST(PP112ALL as DECIMAL(18,5)),
CAST(PP113ALL as DECIMAL(18,5)),
CAST(PP114ALL as DECIMAL(18,5)),
CAST(PP120ALL as DECIMAL(18,5)),
CAST(PP121ALL as DECIMAL(18,5)),
CAST(PP122ALL as DECIMAL(18,5)),
CAST(PP123ALL as DECIMAL(18,5)),
CAST(PP124ALL as DECIMAL(18,5)),
CAST(PP300ALL as DECIMAL(18,5)),
CAST(PP301ALL as DECIMAL(18,5)),
CAST(PP302ALL as DECIMAL(18,5)),
CAST(PP303ALL as DECIMAL(18,5)),
CAST(PP304ALL as DECIMAL(18,5)),
CAST(PP305ALL as DECIMAL(18,5)),
CAST(PP317ALL as DECIMAL(18,5)),
CAST(PP318ALL as DECIMAL(18,5)),
CAST(PP319ALL as DECIMAL(18,5)),
CAST(PP320ALL as DECIMAL(18,5)),
CAST(PP321ALL as DECIMAL(18,5)),
CAST(PP322ALL as DECIMAL(18,5)),
CAST(PP323ALL as DECIMAL(18,5)),
CAST(PP324ALL as DECIMAL(18,5)),
CAST(PP325ALL as DECIMAL(18,5)),
CAST(PP326ALL as DECIMAL(18,5)),
CAST(PP327ALL as DECIMAL(18,5)),
CAST(PP328ALL as DECIMAL(18,5)),
CAST(PP335ALL as DECIMAL(18,5)),
CAST(PP336ALL as DECIMAL(18,5)),
CAST(PP337ALL as DECIMAL(18,5)),
CAST(PP338ALL as DECIMAL(18,5)),
CAST(PP339ALL as DECIMAL(18,5)),
CAST(PP340ALL as DECIMAL(18,5)),
CAST(PP366ALL as DECIMAL(18,5)),
CAST(PP367ALL as DECIMAL(18,5)),
CAST(PP368ALL as DECIMAL(18,5)),
CAST(PP369ALL as DECIMAL(18,5)),
CAST(PP370ALL as DECIMAL(18,5)),
CAST(PP371ALL as DECIMAL(18,5)),
CAST(PP377ALL as DECIMAL(18,5)),
CAST(PP378ALL as DECIMAL(18,5)),
CAST(PP379ALL as DECIMAL(18,5)),
CAST(PP380ALL as DECIMAL(18,5)),
CAST(PP381ALL as DECIMAL(18,5)),
CAST(PP382ALL as DECIMAL(18,5)),
CAST(PP388ALL as DECIMAL(18,5)),
CAST(PP389ALL as DECIMAL(18,5)),
CAST(PP390ALL as DECIMAL(18,5)),
CAST(PP391ALL as DECIMAL(18,5)),
CAST(PP392ALL as DECIMAL(18,5)),
CAST(PP393ALL as DECIMAL(18,5)),
CAST(PP504ALL as DECIMAL(18,5)),
CAST(PP530ALL as DECIMAL(18,5)),
CAST(PP533ALL as DECIMAL(18,5)),
CAST(PP539ALL as DECIMAL(18,5)),
CAST(PP547ALL as DECIMAL(18,5)),
CAST(PP557ALL as DECIMAL(18,5)),
CAST(PP566ALL as DECIMAL(18,5)),
CAST(EQ002ALL as DECIMAL(18,5)),
CAST(EQ003ALL as DECIMAL(18,5)),
CAST(EQ005ALL as DECIMAL(18,5)),
CAST(PP001CRD as DECIMAL(18,5)),
CAST(PP002CRD as DECIMAL(18,5)),
CAST(PP003CRD as DECIMAL(18,5)),
CAST(PP004CRD as DECIMAL(18,5)),
CAST(PP005CRD as DECIMAL(18,5)),
CAST(PP009CRD as DECIMAL(18,5)),
CAST(PP010CRD as DECIMAL(18,5)),
CAST(PP011CRD as DECIMAL(18,5)),
CAST(PP012CRD as DECIMAL(18,5)),
CAST(PP013CRD as DECIMAL(18,5)),
CAST(PP014CRD as DECIMAL(18,5)),
CAST(PP015CRD as DECIMAL(18,5)),
CAST(PP016CRD as DECIMAL(18,5)),
CAST(PP105CRD as DECIMAL(18,5)),
CAST(PP106CRD as DECIMAL(18,5)),
CAST(PP107CRD as DECIMAL(18,5)),
CAST(PP108CRD as DECIMAL(18,5)),
CAST(PP109CRD as DECIMAL(18,5)),
CAST(PP110CRD as DECIMAL(18,5)),
CAST(PP111CRD as DECIMAL(18,5)),
CAST(PP112CRD as DECIMAL(18,5)),
CAST(PP113CRD as DECIMAL(18,5)),
CAST(PP114CRD as DECIMAL(18,5)),
CAST(PP120CRD as DECIMAL(18,5)),
CAST(PP121CRD as DECIMAL(18,5)),
CAST(PP122CRD as DECIMAL(18,5)),
CAST(PP123CRD as DECIMAL(18,5)),
CAST(PP124CRD as DECIMAL(18,5)),
CAST(PP300CRD as DECIMAL(18,5)),
CAST(PP301CRD as DECIMAL(18,5)),
CAST(PP302CRD as DECIMAL(18,5)),
CAST(PP303CRD as DECIMAL(18,5)),
CAST(PP304CRD as DECIMAL(18,5)),
CAST(PP305CRD as DECIMAL(18,5)),
CAST(PP317CRD as DECIMAL(18,5)),
CAST(PP318CRD as DECIMAL(18,5)),
CAST(PP319CRD as DECIMAL(18,5)),
CAST(PP320CRD as DECIMAL(18,5)),
CAST(PP321CRD as DECIMAL(18,5)),
CAST(PP322CRD as DECIMAL(18,5)),
CAST(PP323CRD as DECIMAL(18,5)),
CAST(PP324CRD as DECIMAL(18,5)),
CAST(PP325CRD as DECIMAL(18,5)),
CAST(PP326CRD as DECIMAL(18,5)),
CAST(PP327CRD as DECIMAL(18,5)),
CAST(PP328CRD as DECIMAL(18,5)),
CAST(PP335CRD as DECIMAL(18,5)),
CAST(PP336CRD as DECIMAL(18,5)),
CAST(PP337CRD as DECIMAL(18,5)),
CAST(PP338CRD as DECIMAL(18,5)),
CAST(PP339CRD as DECIMAL(18,5)),
CAST(PP340CRD as DECIMAL(18,5)),
CAST(PP366CRD as DECIMAL(18,5)),
CAST(PP367CRD as DECIMAL(18,5)),
CAST(PP368CRD as DECIMAL(18,5)),
CAST(PP369CRD as DECIMAL(18,5)),
CAST(PP370CRD as DECIMAL(18,5)),
CAST(PP371CRD as DECIMAL(18,5)),
CAST(PP377CRD as DECIMAL(18,5)),
CAST(PP378CRD as DECIMAL(18,5)),
CAST(PP379CRD as DECIMAL(18,5)),
CAST(PP380CRD as DECIMAL(18,5)),
CAST(PP381CRD as DECIMAL(18,5)),
CAST(PP382CRD as DECIMAL(18,5)),
CAST(PP388CRD as DECIMAL(18,5)),
CAST(PP389CRD as DECIMAL(18,5)),
CAST(PP390CRD as DECIMAL(18,5)),
CAST(PP391CRD as DECIMAL(18,5)),
CAST(PP392CRD as DECIMAL(18,5)),
CAST(PP393CRD as DECIMAL(18,5)),
CAST(PP504CRD as DECIMAL(18,5)),
CAST(PP530CRD as DECIMAL(18,5)),
CAST(PP533CRD as DECIMAL(18,5)),
CAST(PP539CRD as DECIMAL(18,5)),
CAST(PP547CRD as DECIMAL(18,5)),
CAST(PP557CRD as DECIMAL(18,5)),
CAST(PP566CRD as DECIMAL(18,5)),
CAST(EQ002CRD as DECIMAL(18,5)),
CAST(EQ003CRD as DECIMAL(18,5)),
CAST(EQ005CRD as DECIMAL(18,5)),
CAST(PP001PLN as DECIMAL(18,5)),
CAST(PP002PLN as DECIMAL(18,5)),
CAST(PP003PLN as DECIMAL(18,5)),
CAST(PP004PLN as DECIMAL(18,5)),
CAST(PP005PLN as DECIMAL(18,5)),
CAST(PP009PLN as DECIMAL(18,5)),
CAST(PP010PLN as DECIMAL(18,5)),
CAST(PP011PLN as DECIMAL(18,5)),
CAST(PP012PLN as DECIMAL(18,5)),
CAST(PP013PLN as DECIMAL(18,5)),
CAST(PP014PLN as DECIMAL(18,5)),
CAST(PP015PLN as DECIMAL(18,5)),
CAST(PP016PLN as DECIMAL(18,5)),
CAST(PP105PLN as DECIMAL(18,5)),
CAST(PP106PLN as DECIMAL(18,5)),
CAST(PP107PLN as DECIMAL(18,5)),
CAST(PP108PLN as DECIMAL(18,5)),
CAST(PP109PLN as DECIMAL(18,5)),
CAST(PP110PLN as DECIMAL(18,5)),
CAST(PP111PLN as DECIMAL(18,5)),
CAST(PP112PLN as DECIMAL(18,5)),
CAST(PP113PLN as DECIMAL(18,5)),
CAST(PP114PLN as DECIMAL(18,5)),
CAST(PP120PLN as DECIMAL(18,5)),
CAST(PP121PLN as DECIMAL(18,5)),
CAST(PP122PLN as DECIMAL(18,5)),
CAST(PP123PLN as DECIMAL(18,5)),
CAST(PP124PLN as DECIMAL(18,5)),
CAST(PP300PLN as DECIMAL(18,5)),
CAST(PP301PLN as DECIMAL(18,5)),
CAST(PP302PLN as DECIMAL(18,5)),
CAST(PP303PLN as DECIMAL(18,5)),
CAST(PP304PLN as DECIMAL(18,5)),
CAST(PP305PLN as DECIMAL(18,5)),
CAST(PP317PLN as DECIMAL(18,5)),
CAST(PP318PLN as DECIMAL(18,5)),
CAST(PP319PLN as DECIMAL(18,5)),
CAST(PP320PLN as DECIMAL(18,5)),
CAST(PP321PLN as DECIMAL(18,5)),
CAST(PP322PLN as DECIMAL(18,5)),
CAST(PP323PLN as DECIMAL(18,5)),
CAST(PP324PLN as DECIMAL(18,5)),
CAST(PP325PLN as DECIMAL(18,5)),
CAST(PP326PLN as DECIMAL(18,5)),
CAST(PP327PLN as DECIMAL(18,5)),
CAST(PP328PLN as DECIMAL(18,5)),
CAST(PP335PLN as DECIMAL(18,5)),
CAST(PP336PLN as DECIMAL(18,5)),
CAST(PP337PLN as DECIMAL(18,5)),
CAST(PP338PLN as DECIMAL(18,5)),
CAST(PP339PLN as DECIMAL(18,5)),
CAST(PP340PLN as DECIMAL(18,5)),
CAST(PP366PLN as DECIMAL(18,5)),
CAST(PP367PLN as DECIMAL(18,5)),
CAST(PP368PLN as DECIMAL(18,5)),
CAST(PP369PLN as DECIMAL(18,5)),
CAST(PP370PLN as DECIMAL(18,5)),
CAST(PP371PLN as DECIMAL(18,5)),
CAST(PP377PLN as DECIMAL(18,5)),
CAST(PP378PLN as DECIMAL(18,5)),
CAST(PP379PLN as DECIMAL(18,5)),
CAST(PP380PLN as DECIMAL(18,5)),
CAST(PP381PLN as DECIMAL(18,5)),
CAST(PP382PLN as DECIMAL(18,5)),
CAST(PP388PLN as DECIMAL(18,5)),
CAST(PP389PLN as DECIMAL(18,5)),
CAST(PP390PLN as DECIMAL(18,5)),
CAST(PP391PLN as DECIMAL(18,5)),
CAST(PP392PLN as DECIMAL(18,5)),
CAST(PP393PLN as DECIMAL(18,5)),
CAST(PP504PLN as DECIMAL(18,5)),
CAST(PP530PLN as DECIMAL(18,5)),
CAST(PP533PLN as DECIMAL(18,5)),
CAST(PP539PLN as DECIMAL(18,5)),
CAST(PP547PLN as DECIMAL(18,5)),
CAST(PP557PLN as DECIMAL(18,5)),
CAST(PP566PLN as DECIMAL(18,5)),
CAST(EQ002PLN as DECIMAL(18,5)),
CAST(EQ003PLN as DECIMAL(18,5)),
CAST(EQ005PLN as DECIMAL(18,5)),
CAST(PP001MTG as DECIMAL(18,5)),
CAST(PP009MTG as DECIMAL(18,5)),
CAST(PP011MTG as DECIMAL(18,5)),
CAST(PP012MTG as DECIMAL(18,5)),
CAST(PP016MTG as DECIMAL(18,5)),
CAST(PP300MTG as DECIMAL(18,5)),
CAST(PP301MTG as DECIMAL(18,5)),
CAST(PP302MTG as DECIMAL(18,5)),
CAST(PP303MTG as DECIMAL(18,5)),
CAST(PP304MTG as DECIMAL(18,5)),
CAST(PP305MTG as DECIMAL(18,5)),
CAST(PP366MTG as DECIMAL(18,5)),
CAST(PP367MTG as DECIMAL(18,5)),
CAST(PP368MTG as DECIMAL(18,5)),
CAST(PP369MTG as DECIMAL(18,5)),
CAST(PP370MTG as DECIMAL(18,5)),
CAST(PP371MTG as DECIMAL(18,5)),
CAST(PP504MTG as DECIMAL(18,5)),
CAST("Secured Accounts Count"  as int),
CAST("Unsecured Accounts Count" as int),
CAST("Secured High Credit Sum"  as VARCHAR(MAX)),
CAST("Unsecured High Credit Sum" as VARCHAR(MAX)),
CAST("Secured Amount Overdue Sum"  as VARCHAR(MAX)),
CAST("Unsecured Amount Overdue Sum" as VARCHAR(MAX)),
CAST("Secured Balances Sum" as VARCHAR(MAX)),
CAST("Unsecured Balances Sum" as VARCHAR(MAX)),
CAST("Own Accounts count" as int),
CAST("Other Accounts count" as int),
CAST("CIBILTUSC3 Score Value" as int),
CAST("CIBILTUSC3 Score Reason Code Set" as VARCHAR(MAX)),
CAST("CIBILTUSC3 Score Exclusion Code Set" as VARCHAR(MAX)),
CAST("CIBILTUSC3 Score Error Code Set" as VARCHAR(MAX))
from nbu.stg_cibil_user_summary join nbu.cibil_master_table on ("Member Reference" = memberreference)
;
